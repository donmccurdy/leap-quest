Quest.Character=function(e){this.options=_.extend({speed:.004,bounceSpeed:300,bounceHeight:2,name:"Hero"},e||{}),this.init()},Quest.Character.prototype.init=function(){var e=new THREE.Mesh(new THREE.CubeGeometry(1,1,1));e.position.set(0,1,0);var t=new THREE.Mesh(new THREE.CubeGeometry(.2,1,.2));t.position.set(0,0,0);var i=new THREE.Mesh(new THREE.CubeGeometry(1.5,.2,.2),new THREE.MeshLambertMaterial({color:5618619}));i.position.set(0,.5,0);var s=new THREE.Geometry;THREE.GeometryUtils.merge(s,e),THREE.GeometryUtils.merge(s,t),THREE.GeometryUtils.merge(s,i),this.mesh=new THREE.Mesh(s,new THREE.MeshLambertMaterial({color:15914802})),this.velocity=new THREE.Vector3(0,0,0),this.constraints={},this.tween=null},Quest.Character.prototype.getMesh=function(){return this.mesh},Quest.Character.prototype.bindEvents=function(e){var t={},i={37:["x",-1],38:["z",-1],39:["x",1],40:["z",1]};e.addEventListener("keydown",_.bind(function(e){var s=i[e.keyCode];s&&!t[s[0]]?(t[s[0]]=1,this.velocity[s[0]]+=s[1]):32!==e.keyCode||this.constraints.y||this.jump()},this)),e.addEventListener("keyup",_.bind(function(e){var s=i[e.keyCode];s&&t[s[0]]&&(t[s[0]]=0,this.velocity[s[0]]-=s[1])},this))},Quest.Character.prototype.jump=function(){if(!this.constraints.y){this.constraints.y=!0;var e=this.mesh.position.y;this.tween=createjs.Tween.get(this.mesh.position).to({y:e+this.options.bounceHeight},.6*this.options.bounceSpeed,createjs.Ease.circOut).to({y:e},1.4*this.options.bounceSpeed,createjs.Ease.bounceOut).call(_.bind(function(){this.constraints.y=!1,this.tween=null},this)),window.tw=this.tween}},Quest.Character.prototype.update=function(e){var t=this.velocity.clone().setLength(e*this.options.speed);this.mesh.position.x+=t.x,this.mesh.position.z+=t.z,this.tween&&this.tween.tick(e)};